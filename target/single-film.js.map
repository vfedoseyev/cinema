{"version":3,"sources":["../js/single-film.js"],"names":["likes","document","getElementById","SearchParams","URLSearchParams","location","search","stars","querySelectorAll","filmId","get","FilmKinopoickData","filmDetailsRequest","answer","json","FilmData","data","console","log","header","posterImage","querySelector","description","premiere","textContent","nameRu","src","posterUrl","premiereRu","fetchfilmMeta","fetch","body","views","ratingNumber","rating","ratings","reduce","a","b","length","intRating","Math","round","floor","i","star","classList","add","likeIcon","FILM_KEY","liked","localStorage","getItem","addEventListener","contains","setItem","likeCount","parseInt","innerText","method","headers","dataset","value","JSON","stringify","$","on","fethcFilmMeta"],"mappings":"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","sourcesContent":["const likes = document.getElementById('sf-likes');\r\nconst SearchParams = new URLSearchParams(location.search);\r\nconst stars = document.querySelectorAll('.rt-star');\r\n\r\nconst filmId = SearchParams.get('id');\r\n\r\nconst FilmKinopoickData = async () => {\r\n    const answer = await filmDetailsRequest(filmId);\r\n    const { data: FilmData } = await answer.json();\r\n    console.log(FilmData)\r\n    const header = document.getElementById('sf-header');\r\n    const posterImage = document.querySelector('#sf-poster');\r\n    const description = document.querySelector('#sf-desc');\r\n    const premiere = document.getElementById('sf-premiere');\r\n\r\n    header.textContent = FilmData.nameRu;\r\n    description.textContent = FilmData.description;\r\n    posterImage.src = FilmData.posterUrl;\r\n    premiere.textContent = FilmData.premiereRu;\r\n\r\n}\r\n\r\nconst fetchfilmMeta = async () => {\r\n    const answer = await fetch(`http://inno-ijl.ru/multystub/stc-21-03/film/${filmId}`);\r\n    const { body } = await answer.json();\r\n\r\n    const views = document.getElementById('sf-views');\r\n\r\n    const ratingNumber = document.getElementById('sf-rating-number');\r\n\r\n    views.textContent = `${body.views} Views`;\r\n    likes.textContent = `${body.likes} likes`;\r\n    const rating = body.ratings.reduce((a, b) => a + b, 0) / body.ratings.length;\r\n    const intRating = Math.round(rating);\r\n    ratingNumber.textContent = Math.floor(rating * 10) / 10;\r\n\r\n    for (let i = 0; i < stars.length; i++) {\r\n        if (i >= intRating) break;\r\n        const star = stars[i];\r\n        star.classList.add('star-selected')\r\n\r\n\r\n    }\r\n}\r\n\r\nconst likeIcon = document.getElementById('like-icon');\r\nconst FILM_KEY = `film-${filmId}`\r\nconst liked = localStorage.getItem(FILM_KEY)\r\nif (!liked === null) {\r\n    likeIcon.classList.add('like-icon--liked')\r\n}\r\nlikeIcon.addEventListener('click', () => {\r\n    if (!likeIcon.classList.contains('like-icon--liked')) {\r\n        localStorage.setItem(FILM_KEY, true)\r\n        const likeCount = parseInt(likes.textContent, 10) + 1;\r\n\r\n        likes.innerText = `${likeCount} Likes`;\r\n        likeIcon.classList.add('like-icon--liked');\r\n        likes.classList.add('like-icon--liked');\r\n\r\n        fetch(\r\n            `http://inno-ijl.ru/multystub/stc-21-03/film/${filmId}/like`,\r\n            {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application'\r\n                },\r\n            }\r\n        );\r\n    }\r\n})\r\n\r\nfor (const star of stars) {\r\n    star.addEventListener('click', () => {\r\n        console.log(star.dataset.value);\r\n\r\n        fetch(`http://inno-ijl.ru/multystub/stc-21-03/film/${filmId}/rating`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({ rating: +star.dataset.value })\r\n        });\r\n\r\n    })\r\n}\r\n\r\n$('.rating_stars').on('click', '.rt-star', async function () {\r\n\r\n    await fetch(`http://inno-ijl.ru/multystub/stc-21-03/film/${filmId}/rating`, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n            rating: +this.dataset.value\r\n        })\r\n    });\r\n    fethcFilmMeta();\r\n})\r\n\r\nFilmKinopoickData();\r\nfetchfilmMeta();"],"file":"single-film.js"}