{"version":3,"sources":["../js/block-films.js"],"names":["blockFilmsWrapper","document","getElementById","innerHTML","renderFilmBlock","posterUrl","filmName","id","wrapper","createElement","classList","add","link","href","imgWrapper","img","src","alt","append","shadow","descWrapper","title","textContent","desc","fetchBlockFilms","topFilmRequest","result","json","data","requests","filmBlocksMap","Map","films","forEach","film","posterUrlPreview","nameRu","filmId","filmBlocks","set","push","Promise","resolve","filmDetailsRequest","detailResult","detailsData","description","all","elements","values","slice"],"mappings":"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","sourcesContent":["const blockFilmsWrapper = document.getElementById('block05-films-wrapper');\r\nblockFilmsWrapper.innerHTML = '';\r\n\r\n\r\n\r\n\r\nfunction renderFilmBlock(posterUrl, filmName, id) {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.classList.add('film__card')\r\n\r\n    const link = document.createElement('a');\r\n    link.href = `/single/?id=${id}`\r\n\r\n    const imgWrapper = document.createElement('div');\r\n    imgWrapper.classList.add('film__img')\r\n    const img = document.createElement('img');\r\n    img.src = posterUrl;\r\n    img.alt = 'Постер к фильму';\r\n\r\n    imgWrapper.append(img);\r\n\r\n    const shadow = document.createElement('div');\r\n    shadow.classList.add('block05__shadow')\r\n\r\n    const descWrapper = document.createElement('div')\r\n    descWrapper.classList.add('films__block')\r\n\r\n    const title = document.createElement('h4')\r\n    title.textContent = filmName;\r\n\r\n    const desc = document.createElement('p')\r\n\r\n\r\n    descWrapper.append(title, desc);\r\n    link.append(imgWrapper, shadow, descWrapper,);\r\n    wrapper.append(link);\r\n    return [wrapper, desc];\r\n}\r\n\r\nconst fetchBlockFilms = async () => {\r\n    const result = await topFilmRequest();\r\n    const data = await result.json();\r\n\r\n    const requests = [];\r\n    const filmBlocksMap = new Map()\r\n\r\n    data.films.forEach(async (film) => {\r\n        const [filmBlocks, desc] = renderFilmBlock(film.posterUrlPreview, film.nameRu, film.filmId);\r\n\r\n        filmBlocksMap.set(film.filmId, filmBlocks)\r\n        requests.push(new Promise(async (resolve) => {\r\n            const detailResult = await filmDetailsRequest(film.filmId);\r\n            const detailsData = await detailResult.json();\r\n\r\n            const description = detailsData.data.description;\r\n\r\n\r\n            if (!description) {\r\n                filmBlocksMap.delete(film.filmId);\r\n            } else {\r\n                desc.textContent = description;\r\n            }\r\n            resolve();\r\n        }))\r\n\r\n\r\n    })\r\n    await Promise.all(requests);\r\n    // let i = 0;\r\n    // for (const [id, element] of filmBlocksMap) {\r\n    //     blockFilmsWrapper.append(element);\r\n    //     i++;\r\n\r\n    //     if (i >= 9) {\r\n    //         break;\r\n    //     }\r\n    // }\r\n    const elements = [...filmBlocksMap.values()].slice(0, 9)\r\n    blockFilmsWrapper.append(...elements);\r\n}\r\nfetchBlockFilms();\r\n    //     blockFilmsWrapper.innerHTML += `\r\n    //     <div class=\"film__card\" id=\"\">\r\n    //         <img class=\"film__img\" src=\"${film.posterUrlPreview}\">\r\n    //         <div class=\"films__block\">\r\n    //             <h4>${film.nameRu}</h4>\r\n    //             <p id =\"${id}\">...loading\r\n    //             </p>\r\n    //         </div>\r\n    //     </div>\r\n    // `\r\n\r\n\r\n\r\n    // fetch('https://kinopoiskapiunofficial.tech/api/v2.2/films/top?type=TOP_AWAIT_FILMS&page=1', {\r\n    //     headers: {\r\n    //         ...apiHeaders\r\n    //     },\r\n    //     cors: 'no-cors'\r\n    // })\r\n    //     .then(data => data.json())\r\n    //     .then(data => {\r\n    //         data.films.forEach((film) => {\r\n    //             const id = `blocks-films-desc-${film.filmId}`\r\n    //             blockFilmsWrapper.innerHTML += `\r\n    //         <div class=\"film__card\" id=\"\">\r\n    //             <img src=\"${film.posterUrlPreview}\">\r\n    //             <div class=\"films__block\">\r\n    //                 <h4>${film.nameRu}</h4>\r\n    //                 <p id =\"${id}\">...loading\r\n    //                 </p>\r\n    //             </div>\r\n    //         </div>\r\n    //     `\r\n\r\n    //             fetch(`https://kinopoiskapiunofficial.tech/api/v2.1/films/${film.filmId}`, {\r\n    //                 headers: {\r\n    //                     ...apiHeaders\r\n    //                 },\r\n    //                 cors: 'no-cors'\r\n    //             })\r\n    //                 .then(data => data.json())\r\n    //                 .then(({ data: { description } }) => {\r\n    //                     const desc = document.getElementById(id);\r\n    //                     desc.innerText = description;\r\n    //                     if (!description) {\r\n    //                         const root = desc.parentNode.parentNode;\r\n    //                         blockFilmsWrapper.removeChild(root);\r\n    //                     }\r\n    //                 })\r\n    //         })\r\n    //     })"],"file":"block-films.js"}